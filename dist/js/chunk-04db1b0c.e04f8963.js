(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04db1b0c","chunk-fbb0194a"],{"0c39":function(t,e,n){"use strict";n("99af"),n("4160"),n("a630"),n("3ca3"),n("159b");var i=n("2b0e");function a(t){if(!(this instanceof a))return new a(t,null,null)}a.treeToArray=function(t,e,n,o){var r=[];return Array.from(t).forEach((function(t){void 0===t._expanded&&i["default"].set(t,"_expanded",o),e&&i["default"].set(t,"_parent",e);var s=0;if(void 0!==n&&null!==n&&(s=n+1),i["default"].set(t,"_level",s),r.push(t),t.childs&&t.childs.length>0){var l=a.treeToArray(t.childs,t,s,o);r=r.concat(l)}if(t.points&&t.points.length>0){var d=a.treeToArray(t.points,t,s,o);r=r.concat(d)}})),r},e["a"]=a},"19b4":function(t,e,n){"use strict";var i=n("fa5f"),a=n.n(i);a.a},"1c4c":function(t,e,n){},"2cc6":function(t,e,n){},"2fa6":function(t,e,n){},"36a5":function(t,e,n){"use strict";var i=n("f9d0"),a=n.n(i);a.a},"37ab":function(t,e,n){},"714e":function(t,e,n){"use strict";var i=n("1c4c"),a=n.n(i);a.a},"73b3":function(t,e,n){"use strict";var i=n("2cc6"),a=n.n(i);a.a},"80f01":function(t,e,n){"use strict";var i=n("2fa6"),a=n.n(i);a.a},c8d28:function(t,e,n){"use strict";n.r(e);var i,a,o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dashboard-container"},[n("div",{staticClass:"app-container"},[n("el-card",{attrs:{shadow:"never"}},[n("el-button",{staticClass:"filter-item fr",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v(t._s(t.$t("table.add")))]),n("tree-table",{attrs:{border:"",data:t.dataList,columns:t.columns,"tree-structure":!0,listLoading:t.listLoading,rowClassStatus:t.rowClassStatus},on:{handleUpdate:t.handleUpdate,removeUser:t.removeUser}}),n(t.MenuAdd,{ref:"editMenu",tag:"component",attrs:{text:t.text,pageTitle:t.pageTitle,PermissionGroupsList:t.PermissionGroupsList,notPointDataList:t.notPointDataList,parentDataList:t.parentDataList},on:{newDataes:t.handleLoadData,handleCloseModal:t.handleCloseModal}})],1)],1)])},r=[],s=(n("a434"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.formatData,"row-class-name":t.rowClassStatus,"element-loading-text":"给我一点时间",fit:"","highlight-current-row":""}},[t._l(t.columns,(function(e,i){return n("el-table-column",{key:e.prop,attrs:{width:e.width,prop:e.prop,label:e.text},scopedSlots:t._u([{key:"default",fn:function(a){return[e.render?n("expand",{attrs:{render:e.render,row:a.row,index:i,column:e}}):n("span",[t._v(" "+t._s(a.row[e.value])+" ")])]}}],null,!0)})})),n("el-table-column",{attrs:{label:"操作",width:"260",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){return t.handleUpdate(e.row)}}},[t._v(" 修改 ")]),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return t.handleDelete(e.row.id)}}},[t._v(" 删除 ")])]}}])})],2)}),l=[],d=n("0c39"),u=(n("a9e3"),{name:"TableExpand",functional:!0,props:{row:Object,render:Function,index:Number,column:{type:Object,default:null}},render:function(t,e){var n={row:e.props.row,index:e.props.index};return e.props.column&&(n.column=e.props.column),e.props.render(t,n)}}),c=u,f=n("2877"),p=Object(f["a"])(c,i,a,!1,null,null,null),h=p.exports,m={name:"treeTable",components:{expand:h},props:{treeStructure:{type:Boolean,default:function(){return!1}},data:{type:Array,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},listLoading:{type:Boolean,default:!1},defaultExpandAll:{type:Boolean,default:function(){return!0}}},computed:{formatData:function(){var t=this;if(t.treeStructure){var e=d["a"].treeToArray(t.data,null,null,t.defaultExpandAll);return e}return t.data}},methods:{rowClassStatus:function(){this.$emit("rowClassStatus")},handleUpdate:function(t){this.$emit("handleUpdate",t)},handleDelete:function(t){this.$emit("removeUser",t)}}},v=m,b=(n("e9b3"),n("714e"),Object(f["a"])(v,s,l,!1,null,"92560e4a",null)),g=b.exports,M=n("d957"),y=n("a394"),w=[],_={name:"treeTableDemo",components:{treeTable:g,MenuAdd:M["default"]},data:function(){return{MenuAdd:"menuAdd",listLoading:!0,dataList:[],newArray:[],pageTitle:"菜单",text:"",PermissionGroupsList:[],parentDataList:[],notPointDataList:[],columns:[{text:"标题",value:"title",width:200,render:function(t,e){return t("div",[t("i",{class:"ivu-icon "+e.row.icon,style:{marginLeft:"".concat(20*e.row.layer,"px"),marginRight:"5px",fontSize:"16px"}}),t("i",e.row.title)])}},{text:"权限点代码",value:"code"}]}},methods:{handleLoadData:function(t){var e=this;this.listLoading=!0,Object(y["c"])(t).then((function(t){e.dataList=t.data,e.listLoading=!1;var n=[],i=function(t,e){var n;n=e.is_point?" el-icon-view":e.childs&&e.childs.length>0?" fa fa-folder-open-o fa-fw":"fa fa-file-o fa-fw";var i={id:e.id,pid:e.pid,layer:t,is_point:e.is_point,code:e.code,title:e.title,icon:n};return i},a=function(t,e){t++,o(t,e),t--};function o(t,e){for(var o=0;o<e.length;o++)n.push(i(t,e[o])),e[o].childs&&e[o].childs.length>0&&a(t,e[o].childs),e[o].points&&e[o].points.length>0&&a(t,e[o].points)}var r=0;o(r,w.dataList),w.dataList=n}))},setupData:function(){var t=this;simple().then((function(e){t.PermissionGroupsList=e.data}))},handleLoadDataList:function(){},rowClassStatus:function(t){return 1===t.row.is_deleted?"disabled":""},handleCreate:function(){this.text="创建",this.$refs.editMenu.dialogFormV(),this.$refs.editMenu.handleResetForm()},handleCloseModal:function(){this.$refs.editMenu.dialogFormH()},handleUpdate:function(t){var e=t.is_point?"points":"menu";w.$refs.editMenu.changeType(e),w.$refs.editMenu.dialogFormV(),w.$refs.editMenu.hanldeEditForm(t.id)},removeUser:function(t){var e=this;this.$confirm("此操作将永久删除用户 , 是否继续?","提示",{type:"warning"}).then((function(){Object(y["d"])({id:t}).then((function(n){e.$message.success("成功删除了用户!"),e.dataList.splice(t,1),e.handleLoadData(e.requestParameters)})).catch((function(t){e.$message.error("删除失败!")}))})).catch((function(){e.$message.info("已取消操作!")}))}},mounted:function(){this.handleLoadData()},created:function(){w=this},updated:function(){},beforeUpdate:function(){}},L=_,$=(n("73b3"),n("80f01"),Object(f["a"])(L,o,r,!1,null,"3e7c8b5c",null));e["default"]=$.exports},d957:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"add-form"},[n("el-dialog",{attrs:{title:t.text+t.pageTitle,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("el-form",{ref:"formMenu",staticStyle:{width:"400px","margin-left":"120px"},attrs:{rules:t.ruleInline,model:t.formMenu,"label-position":"left","label-width":"120px"}},[n("el-form-item",{attrs:{label:t.$t("table.permissionUser")}},[n("el-radio-group",{staticClass:"choose-type",on:{change:t.handleChooseType},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[n("el-radio",{staticClass:"choose-item",attrs:{label:"menu",disabled:t.typeStatus}},[t._v("菜单")]),n("el-radio",{staticClass:"choose-item",attrs:{label:"points",disabled:t.typeStatus}},[t._v("权限点")])],1)],1),n("el-form-item",{attrs:{label:t.$t("table.permissionUser")}},[n("el-select",{model:{value:t.formMenu.pid,callback:function(e){t.$set(t.formMenu,"pid",e)},expression:"formMenu.pid"}},[n("el-option",{attrs:{value:0,label:t.$t("table.powerNav")}},[t._v("主导航")]),t._l(t.notPointDataList,(function(e){return n("el-option",{key:e.id,class:"moveIn"+e.layer,attrs:{value:e.id,label:e.title,disabled:"points"===t.type&&!!e.childs}})}))],2)],1),t.showMenuBlock?n("div",[n("el-form-item",{attrs:{label:t.$t("table.powerCode"),prop:"code"}},[n("el-input",{model:{value:t.formMenu.code,callback:function(e){t.$set(t.formMenu,"code",e)},expression:"formMenu.code"}})],1),n("el-form-item",{attrs:{label:t.$t("table.powerTitle"),prop:"title"}},[n("el-input",{model:{value:t.formMenu.title,callback:function(e){t.$set(t.formMenu,"title",e)},expression:"formMenu.title"}})],1)],1):t._e(),t.showPointBlock?n("div",{attrs:{model:t.formPoints}},[n("el-form-item",{attrs:{label:t.$t("table.powerCode"),prop:"code"}},[n("el-input",{model:{value:t.formPoints.code,callback:function(e){t.$set(t.formPoints,"code",e)},expression:"formPoints.code"}})],1),n("el-form-item",{attrs:{label:t.$t("table.powerTitle"),prop:"title"}},[n("el-input",{model:{value:t.formPoints.title,callback:function(e){t.$set(t.formPoints,"title",e)},expression:"formPoints.title"}})],1)],1):t._e()],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.handleClose}},[t._v(t._s(t.$t("table.cancel")))]),n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formMenu")}}},[t._v(t._s(t.$t("table.confirm")))])],1)],1)],1)},a=[],o=(n("a9e3"),n("a394")),r=(n("0c39"),[]),s={name:"items",props:{treeStructure:{type:Boolean,default:function(){return!1}},text:{type:String},pageTitle:{type:String},PermissionGroupsList:{type:Array}},data:function(){var t=function t(e,n,i){var a=r.formMenu.code;if(""===n)i(new Error("代码不能为空"));else{t.ifHave=!1;var o=r.formMenu.pid;t.ifHaveCodeExciting=function(e){for(var n=0;n<e.length;n++)e[n].childs&&e[n].childs.length>0&&t.ifHaveCodeExciting(e[n].childs),e[n].points&&e[n].points.length>0&&e[n].id===o&&t.doPoints(e[n].points)},t.doPoints=function(e){for(var n=0;n<e.length;n++)e[n].code&&e[n].code===a&&(t.ifHave=!0)},t.ifHaveCodeExciting(r.parentDataList),i()}};return{type:"menu",showMenuBlock:!0,showPointBlock:!1,dialogFormVisible:!1,typeStatus:!1,notPointDataList:[],parentDataList:[],formMenu:{pid:"",is_point:"",code:"",title:""},formPoints:{pid:"",is_point:"",code:"",title:""},codepast:"",ruleInline:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],code:[{required:!0,validator:t,trigger:"blur"}]},leafCount:[]}},computed:{},methods:{dialogFormV:function(){this.dialogFormVisible=!0},dialogFormH:function(){this.dialogFormVisible=!1},handleChooseType:function(){"menu"===this.type&&r.changeToMenu(),"points"===this.type&&r.changeToPoints()},changeType:function(t){"menu"===t&&(this.type="menu",r.changeToMenu()),"points"===t&&(this.type="points",r.changeToPoints()),this.typeStatus=!0},changeArays:function(){var t=function t(e){for(var n=0;n<e.length;n++)void 0!==e[n].code&&r.notPointDataList.push(e[n]),e[n].childs&&e[n].childs.length>0&&t(e[n].childs)};t(r.parentDataList)},changeToMenu:function(){r.showMenuBlock=!0,r.showPointBlock=!1,r.notPointDataList=[],this.changeArays()},changeToPoints:function(){r.showMenuBlock=!1,r.showPointBlock=!0,r.formMenu=r.formPoints,r.formMenu.pid=r.formPoints.pid,r.formMenu.code=r.formPoints.code,r.formMenu.title=r.formPoints.title,r.notPointDataList=[],this.changeArays()},handleClose:function(){this.$emit("handleCloseModal")},handle_Edit:function(t){var e=this;Object(o["f"])(this.formMenu).then((function(){e.$emit("handleCloseModal"),e.$emit("newDataes",e.formMenu)}))},select_Add:function(){var t=this;Object(o["a"])(this.formMenu).then((function(){r.handleResetForm(),t.$emit("handleCloseModal"),t.$emit("newDataes",t.formMenu)}))},handle_Add:function(t){"points"===r.type?(this.formMenu.is_point=!0,this.select_Add()):(this.formMenu.is_point=!1,this.select_Add())},handleSubmit:function(t){var e=this;if(r.formMenu.pid=Number(r.formMenu.pid),r.formMenu.id){var n=r.formMenu.code;n===this.codepast?(this.$refs.formMenu.validateField("title"),r.handle_Edit(t)):r.$refs[t].validate((function(n){n?r.handle_Edit(t):e.$Message.error("表单验证失败")}))}else r.$refs[t].validate((function(n){n?r.handle_Add(t):e.$Message.error("表单验证失败")}))},dataRest:function(t){for(var e=0;e<t.length;e++){if(t[e].childs&&t[e].childs.length>0)for(var n=0;n<t[e].childs.length;n++)this.$set(t[e].childs[n],"layer",1);this.$set(t[e],"layer",0)}},hanldeEditForm:function(t){var e=this;this.formMenu.id=t,Object(o["c"])().then((function(t){r.parentDataList=t.data,r.notPointDataList=[],e.dataRest(t.data),e.changeArays()})),Object(o["b"])({id:t}).then((function(t){e.formMenu.id=t.data.id,e.formMenu.pid=t.data.pid,e.formMenu.title=t.data.title,e.formMenu.code=t.data.code,e.formMenu.is_point=t.data.is_point;var n=t.data,i=e.type;"points"===i&&(e.formMenu.code=t.data.code),null===n.pid&&(e.formMenu.pid=0)}))},handleResetForm:function(){var t=this;this.formMenu.id="",this.formMenu.pid=0,this.formMenu.title="",this.formMenu.code="",r.typeStatus=!1,r.type="menu",Object(o["c"])().then((function(e){r.parentDataList=e.data,r.notPointDataList=r.parentDataList,t.dataRest(e.data),r.changeToMenu()}))}},mounted:function(){},created:function(){r=this},updated:function(){}},l=s,d=(n("36a5"),n("19b4"),n("2877")),u=Object(d["a"])(l,i,a,!1,null,"701fabc8",null);e["default"]=u.exports},e9b3:function(t,e,n){"use strict";var i=n("37ab"),a=n.n(i);a.a},f9d0:function(t,e,n){},fa5f:function(t,e,n){}}]);
//# sourceMappingURL=chunk-04db1b0c.e04f8963.js.map